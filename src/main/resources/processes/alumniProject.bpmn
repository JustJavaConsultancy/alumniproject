<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xmlns:xsd="http://www.w3.org/2001/XMLSchema"
              xmlns:flowable="http://flowable.org/bpmn"
              xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
              xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
              xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
              typeLanguage="http://www.w3.org/2001/XMLSchema"
              expressionLanguage="http://www.w3.org/1999/XPath"
              targetNamespace="http://flowable.org/test">
  <process id="alumniProject" name="Alumni Document Request Process" isExecutable="true">
    <startEvent id="startEvent" name="Start"/>
    <userTask id="submitRequest" name="Submit Document Request" flowable:formKey="alumniRequestForm">
      <extensionElements>
        <flowable:formProperty id="documentType" name="Document Type" type="enum" required="true">
          <flowable:value id="transcript" name="Transcript"/>
          <flowable:value id="certificate" name="Certificate"/>
          <flowable:value id="letterOfAttestation" name="Letter of Attestation"/>
        </flowable:formProperty>
        <flowable:formProperty id="paymentMethod" name="Payment Method" type="enum" required="true">
          <flowable:value id="remita" name="Remita"/>
          <flowable:value id="paystack" name="Paystack"/>
          <flowable:value id="interswitch" name="Interswitch"/>
        </flowable:formProperty>
      </extensionElements>
    </userTask>
    <serviceTask id="calculatePayment" name="Calculate Payment Amount" flowable:class="com.flowable.alumni.CalculatePaymentDelegate"/>
    <userTask id="makePayment" name="Make Payment" flowable:formKey="paymentForm"/>
    <serviceTask id="verifyPayment" name="Verify Payment" flowable:class="com.flowable.alumni.VerifyPaymentDelegate"/>
    <exclusiveGateway id="paymentVerified" name="Payment Verified?" default="paymentFailed"/>
    <endEvent id="paymentFailed" name="Payment Failed"/>
    <userTask id="submitRequestToStaff" name="Submit Request to Staff" flowable:assignee="${approver}"/>
    <serviceTask id="retrieveAcademicRecords" name="Retrieve Academic Records" flowable:class="com.flowable.alumni.RetrieveAcademicRecordsDelegate"/>
    <userTask id="approveRequest" name="Approve Request" flowable:assignee="${approver}"/>
    <exclusiveGateway id="requestApproved" name="Request Approved?" default="requestRejected"/>
    <endEvent id="requestRejected" name="Request Rejected"/>
    <serviceTask id="generateDocument" name="Generate Document" flowable:class="com.flowable.alumni.GenerateDocumentDelegate"/>
    <serviceTask id="sendNotification" name="Send Notification" flowable:class="com.flowable.alumni.SendNotificationDelegate"/>
    <endEvent id="endEvent" name="End"/>

    <sequenceFlow id="flow1" sourceRef="startEvent" targetRef="submitRequest"/>
    <sequenceFlow id="flow2" sourceRef="submitRequest" targetRef="calculatePayment"/>
    <sequenceFlow id="flow3" sourceRef="calculatePayment" targetRef="makePayment"/>
    <sequenceFlow id="flow4" sourceRef="makePayment" targetRef="verifyPayment"/>
    <sequenceFlow id="flow5" sourceRef="verifyPayment" targetRef="paymentVerified"/>
    <sequenceFlow id="flow6" sourceRef="paymentVerified" targetRef="paymentFailed"/>
    <sequenceFlow id="flow7" sourceRef="paymentVerified" targetRef="submitRequestToStaff">
      <conditionExpression xsi:type="tFormalExpression" language="http://www.w3.org/1999/XPath">paymentVerified</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow8" sourceRef="submitRequestToStaff" targetRef="retrieveAcademicRecords"/>
    <sequenceFlow id="flow9" sourceRef="retrieveAcademicRecords" targetRef="approveRequest"/>
    <sequenceFlow id="flow10" sourceRef="approveRequest" targetRef="requestApproved"/>
    <sequenceFlow id="flow11" sourceRef="requestApproved" targetRef="requestRejected"/>
    <sequenceFlow id="flow12" sourceRef="requestApproved" targetRef="generateDocument">
      <conditionExpression xsi:type="tFormalExpression" language="http://www.w3.org/1999/XPath">requestApproved</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow13" sourceRef="generateDocument" targetRef="sendNotification"/>
    <sequenceFlow id="flow14" sourceRef="sendNotification" targetRef="endEvent"/>
  </process>

  <bpmndi:BPMNDiagram id="BPMNDiagram_alumniProject">
    <bpmndi:BPMNPlane bpmnElement="alumniProject" id="BPMNPlane_alumniProject">
      <bpmndi:BPMNShape bpmnElement="startEvent">
        <omgdc:Bounds x="150" y="200" width="30" height="30"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="submitRequest">
        <omgdc:Bounds x="350" y="180" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="calculatePayment">
        <omgdc:Bounds x="550" y="180" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="makePayment">
        <omgdc:Bounds x="750" y="180" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="verifyPayment">
        <omgdc:Bounds x="950" y="180" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="paymentVerified">
        <omgdc:Bounds x="1150" y="190" width="40" height="40"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="paymentFailed">
        <omgdc:Bounds x="1350" y="200" width="30" height="30"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="submitRequestToStaff">
        <omgdc:Bounds x="1350" y="100" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="retrieveAcademicRecords">
        <omgdc:Bounds x="1550" y="100" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="approveRequest">
        <omgdc:Bounds x="1750" y="100" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="requestApproved">
        <omgdc:Bounds x="1950" y="110" width="40" height="40"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="requestRejected">
        <omgdc:Bounds x="2150" y="120" width="30" height="30"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="generateDocument">
        <omgdc:Bounds x="2150" y="20" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sendNotification">
        <omgdc:Bounds x="2350" y="20" width="120" height="80"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endEvent">
        <omgdc:Bounds x="2550" y="20" width="30" height="30"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNEdge bpmnElement="flow1">
        <omgdi:waypoint x="180" y="215"/>
        <omgdi:waypoint x="350" y="215"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow2">
        <omgdi:waypoint x="470" y="215"/>
        <omgdi:waypoint x="550" y="215"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow3">
        <omgdi:waypoint x="670" y="215"/>
        <omgdi:waypoint x="750" y="215"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4">
        <omgdi:waypoint x="870" y="215"/>
        <omgdi:waypoint x="950" y="215"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5">
        <omgdi:waypoint x="1070" y="215"/>
        <omgdi:waypoint x="1150" y="215"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6">
        <omgdi:waypoint x="1190" y="230"/>
        <omgdi:waypoint x="1350" y="230"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow7">
        <omgdi:waypoint x="1190" y="190"/>
        <omgdi:waypoint x="1350" y="140"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8">
        <omgdi:waypoint x="1470" y="140"/>
        <omgdi:waypoint x="1550" y="140"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow9">
        <omgdi:waypoint x="1670" y="140"/>
        <omgdi:waypoint x="1750" y="140"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow10">
        <omgdi:waypoint x="1870" y="140"/>
        <omgdi:waypoint x="1950" y="140"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow11">
        <omgdi:waypoint x="1990" y="150"/>
        <omgdi:waypoint x="2150" y="150"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12">
        <omgdi:waypoint x="1990" y="110"/>
        <omgdi:waypoint x="2150" y="60"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13">
        <omgdi:waypoint x="2270" y="60"/>
        <omgdi:waypoint x="2350" y="60"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow14">
        <omgdi:waypoint x="2470" y="60"/>
        <omgdi:waypoint x="2550" y="60"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>